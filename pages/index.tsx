import { Tab } from '@headlessui/react';
import type { NextPage } from 'next';
import Head from 'next/head';
import Image from 'next/image';
import { useEffect, useState } from 'react';
import InfiniteScroll from 'react-infinite-scroll-component';
import { Carousel, Categories } from '../components/Carousel';
import { Layout } from '../components/Layout';
import { MoviesGrid } from '../components/MoviesGrid';
import useResults from '../hooks/useResults';
import { Movie } from '../interfaces/Movie';
import { MovieList } from '../interfaces/MovieList';
import { filterResults } from '../services/filterResults';

const Hero = ({ bgImage }: { bgImage?: string }) => {
  return (
    <div className="bg-blue-800 -mx-4 sm:-mx-8 p-4 ">
      <div className="text-white my-4">
        <h1 className="text-5xl font-bold">Welcome.</h1>
        <h2 className="text-3xl">
          Millions of movies, TV
          <br /> shows and people to discover. Explore now.
        </h2>
        <form className="flex justify-between bg-white rounded-3xl mt-4">
          <input
            className="rounded-3xl ml-4 focus:outline-none text-black"
            placeholder="Search..."
          />
          <button className="bg-green-500  font-semibold py-3 px-6  rounded-3xl">Search</button>
        </form>
      </div>
    </div>
  );
};

const Home = () => {
  const popularCategories: Categories = [
    { name: 'Streaming', api: 'discover?category=tv&monetization=flatrate', type: 'tv' },
    { name: 'On TV', api: 'tv?category=popular&page=1', type: 'tv' },
    { name: 'Movies', api: 'movies?category=now_playing&page=1', type: 'movie' },
    { name: 'For Rent', api: 'discover?category=movie&monetization=rent', type: 'movie' },
  ];
  const freeCategories: Categories = [
    { name: 'Movies', api: 'discover?category=movie&monetization=free', type: 'movie' },
    { name: 'TV', api: 'discover?category=tv&monetization=free', type: 'tv' },
  ];
  return (
    <Layout>
      <Head>
        <title>HELLO</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Hero />
      <div>
        <Carousel title="What's Popular" categories={popularCategories} />
        <Carousel title="Free to Watch" categories={freeCategories} />
      </div>
      {/* <MoviesGrid data={data} api="movies" /> */}
    </Layout>
  );
};

// export const getServerSideProps = async () => {
// `https://api.themoviedb.org/3/movie/popular?api_key=${
//   process.env.MOVIES_API
// }&language=en-US&page=${1}`;

//   const data = await fetch(
//     `https://api.themoviedb.org/3/trending/all/week?api_key=${process.env.MOVIES_API}`
//   ).then((res) => res.json());
//   const filteredResults = filterResults(data.results);
//   return {
//     props: {
//       data: {
//         ...data,
//         results: filteredResults,
//         total_results: filteredResults.length,
//       },
//     },
//   };
// };

export default Home;
